// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: transporters.sql

package db

import (
	"context"
	"database/sql"
)

const ActivateTransporter = `-- name: ActivateTransporter :exec
UPDATE transporters SET is_active = 1, updated_at = CURRENT_TIMESTAMP
WHERE id = ? AND project_id = ?
`

type ActivateTransporterParams struct {
	ID        int64
	ProjectID int64
}

func (q *Queries) ActivateTransporter(ctx context.Context, arg ActivateTransporterParams) error {
	_, err := q.db.ExecContext(ctx, ActivateTransporter, arg.ID, arg.ProjectID)
	return err
}

const CreateTransporter = `-- name: CreateTransporter :execresult
INSERT INTO transporters (project_id, company_name, contact_person, phone, gst_number, is_active)
VALUES (?, ?, ?, ?, ?, ?)
`

type CreateTransporterParams struct {
	ProjectID     int64
	CompanyName   string
	ContactPerson sql.NullString
	Phone         sql.NullString
	GstNumber     sql.NullString
	IsActive      sql.NullBool
}

func (q *Queries) CreateTransporter(ctx context.Context, arg CreateTransporterParams) (sql.Result, error) {
	return q.db.ExecContext(ctx, CreateTransporter,
		arg.ProjectID,
		arg.CompanyName,
		arg.ContactPerson,
		arg.Phone,
		arg.GstNumber,
		arg.IsActive,
	)
}

const CreateVehicle = `-- name: CreateVehicle :execresult
INSERT INTO transporter_vehicles (transporter_id, vehicle_number, vehicle_type, driver_name, driver_phone1, driver_phone2)
VALUES (?, ?, ?, ?, ?, ?)
`

type CreateVehicleParams struct {
	TransporterID int64
	VehicleNumber string
	VehicleType   sql.NullString
	DriverName    sql.NullString
	DriverPhone1  sql.NullString
	DriverPhone2  sql.NullString
}

func (q *Queries) CreateVehicle(ctx context.Context, arg CreateVehicleParams) (sql.Result, error) {
	return q.db.ExecContext(ctx, CreateVehicle,
		arg.TransporterID,
		arg.VehicleNumber,
		arg.VehicleType,
		arg.DriverName,
		arg.DriverPhone1,
		arg.DriverPhone2,
	)
}

const DeactivateTransporter = `-- name: DeactivateTransporter :exec
UPDATE transporters SET is_active = 0, updated_at = CURRENT_TIMESTAMP
WHERE id = ? AND project_id = ?
`

type DeactivateTransporterParams struct {
	ID        int64
	ProjectID int64
}

func (q *Queries) DeactivateTransporter(ctx context.Context, arg DeactivateTransporterParams) error {
	_, err := q.db.ExecContext(ctx, DeactivateTransporter, arg.ID, arg.ProjectID)
	return err
}

const DeleteVehicle = `-- name: DeleteVehicle :exec
DELETE FROM transporter_vehicles WHERE id = ? AND transporter_id = ?
`

type DeleteVehicleParams struct {
	ID            int64
	TransporterID int64
}

func (q *Queries) DeleteVehicle(ctx context.Context, arg DeleteVehicleParams) error {
	_, err := q.db.ExecContext(ctx, DeleteVehicle, arg.ID, arg.TransporterID)
	return err
}

const GetActiveTransportersByProjectID = `-- name: GetActiveTransportersByProjectID :many
SELECT id, project_id, company_name, contact_person, phone, gst_number,
       is_active, created_at, updated_at
FROM transporters
WHERE project_id = ? AND is_active = 1
ORDER BY company_name ASC
`

func (q *Queries) GetActiveTransportersByProjectID(ctx context.Context, projectID int64) ([]Transporter, error) {
	rows, err := q.db.QueryContext(ctx, GetActiveTransportersByProjectID, projectID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Transporter{}
	for rows.Next() {
		var i Transporter
		if err := rows.Scan(
			&i.ID,
			&i.ProjectID,
			&i.CompanyName,
			&i.ContactPerson,
			&i.Phone,
			&i.GstNumber,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const GetTransporterByID = `-- name: GetTransporterByID :one
SELECT id, project_id, company_name, contact_person, phone, gst_number,
       is_active, created_at, updated_at
FROM transporters
WHERE id = ?
`

func (q *Queries) GetTransporterByID(ctx context.Context, id int64) (Transporter, error) {
	row := q.db.QueryRowContext(ctx, GetTransporterByID, id)
	var i Transporter
	err := row.Scan(
		&i.ID,
		&i.ProjectID,
		&i.CompanyName,
		&i.ContactPerson,
		&i.Phone,
		&i.GstNumber,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const GetTransporterCount = `-- name: GetTransporterCount :one
SELECT COUNT(*) FROM transporters WHERE project_id = ? AND is_active = 1
`

func (q *Queries) GetTransporterCount(ctx context.Context, projectID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, GetTransporterCount, projectID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const GetTransportersByProjectID = `-- name: GetTransportersByProjectID :many
SELECT id, project_id, company_name, contact_person, phone, gst_number,
       is_active, created_at, updated_at
FROM transporters
WHERE project_id = ?
ORDER BY company_name ASC
`

func (q *Queries) GetTransportersByProjectID(ctx context.Context, projectID int64) ([]Transporter, error) {
	rows, err := q.db.QueryContext(ctx, GetTransportersByProjectID, projectID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Transporter{}
	for rows.Next() {
		var i Transporter
		if err := rows.Scan(
			&i.ID,
			&i.ProjectID,
			&i.CompanyName,
			&i.ContactPerson,
			&i.Phone,
			&i.GstNumber,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const GetVehicleByID = `-- name: GetVehicleByID :one
SELECT id, transporter_id, vehicle_number, vehicle_type,
       driver_name, driver_phone1, driver_phone2, created_at
FROM transporter_vehicles
WHERE id = ?
`

type GetVehicleByIDRow struct {
	ID            int64
	TransporterID int64
	VehicleNumber string
	VehicleType   sql.NullString
	DriverName    sql.NullString
	DriverPhone1  sql.NullString
	DriverPhone2  sql.NullString
	CreatedAt     sql.NullTime
}

func (q *Queries) GetVehicleByID(ctx context.Context, id int64) (GetVehicleByIDRow, error) {
	row := q.db.QueryRowContext(ctx, GetVehicleByID, id)
	var i GetVehicleByIDRow
	err := row.Scan(
		&i.ID,
		&i.TransporterID,
		&i.VehicleNumber,
		&i.VehicleType,
		&i.DriverName,
		&i.DriverPhone1,
		&i.DriverPhone2,
		&i.CreatedAt,
	)
	return i, err
}

const GetVehiclesByTransporterID = `-- name: GetVehiclesByTransporterID :many
SELECT id, transporter_id, vehicle_number, vehicle_type,
       driver_name, driver_phone1, driver_phone2, created_at
FROM transporter_vehicles
WHERE transporter_id = ?
ORDER BY vehicle_number ASC
`

type GetVehiclesByTransporterIDRow struct {
	ID            int64
	TransporterID int64
	VehicleNumber string
	VehicleType   sql.NullString
	DriverName    sql.NullString
	DriverPhone1  sql.NullString
	DriverPhone2  sql.NullString
	CreatedAt     sql.NullTime
}

func (q *Queries) GetVehiclesByTransporterID(ctx context.Context, transporterID int64) ([]GetVehiclesByTransporterIDRow, error) {
	rows, err := q.db.QueryContext(ctx, GetVehiclesByTransporterID, transporterID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []GetVehiclesByTransporterIDRow{}
	for rows.Next() {
		var i GetVehiclesByTransporterIDRow
		if err := rows.Scan(
			&i.ID,
			&i.TransporterID,
			&i.VehicleNumber,
			&i.VehicleType,
			&i.DriverName,
			&i.DriverPhone1,
			&i.DriverPhone2,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const IsVehicleUsedInDC = `-- name: IsVehicleUsedInDC :one
SELECT COUNT(*) FROM dc_transit_details WHERE vehicle_number = ?
`

func (q *Queries) IsVehicleUsedInDC(ctx context.Context, vehicleNumber sql.NullString) (int64, error) {
	row := q.db.QueryRowContext(ctx, IsVehicleUsedInDC, vehicleNumber)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const SearchTransporters = `-- name: SearchTransporters :many
SELECT id, project_id, company_name, contact_person, phone, gst_number,
       is_active, created_at, updated_at
FROM transporters
WHERE project_id = ?
  AND (company_name LIKE ? OR contact_person LIKE ? OR phone LIKE ? OR gst_number LIKE ?)
ORDER BY company_name ASC
LIMIT ? OFFSET ?
`

type SearchTransportersParams struct {
	ProjectID     int64
	CompanyName   string
	ContactPerson sql.NullString
	Phone         sql.NullString
	GstNumber     sql.NullString
	Limit         int64
	Offset        int64
}

func (q *Queries) SearchTransporters(ctx context.Context, arg SearchTransportersParams) ([]Transporter, error) {
	rows, err := q.db.QueryContext(ctx, SearchTransporters,
		arg.ProjectID,
		arg.CompanyName,
		arg.ContactPerson,
		arg.Phone,
		arg.GstNumber,
		arg.Limit,
		arg.Offset,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Transporter{}
	for rows.Next() {
		var i Transporter
		if err := rows.Scan(
			&i.ID,
			&i.ProjectID,
			&i.CompanyName,
			&i.ContactPerson,
			&i.Phone,
			&i.GstNumber,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const SearchTransportersCount = `-- name: SearchTransportersCount :one
SELECT COUNT(*) FROM transporters
WHERE project_id = ?
  AND (company_name LIKE ? OR contact_person LIKE ? OR phone LIKE ? OR gst_number LIKE ?)
`

type SearchTransportersCountParams struct {
	ProjectID     int64
	CompanyName   string
	ContactPerson sql.NullString
	Phone         sql.NullString
	GstNumber     sql.NullString
}

func (q *Queries) SearchTransportersCount(ctx context.Context, arg SearchTransportersCountParams) (int64, error) {
	row := q.db.QueryRowContext(ctx, SearchTransportersCount,
		arg.ProjectID,
		arg.CompanyName,
		arg.ContactPerson,
		arg.Phone,
		arg.GstNumber,
	)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const SearchTransportersCountNoFilter = `-- name: SearchTransportersCountNoFilter :one
SELECT COUNT(*) FROM transporters WHERE project_id = ?
`

func (q *Queries) SearchTransportersCountNoFilter(ctx context.Context, projectID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, SearchTransportersCountNoFilter, projectID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const SearchTransportersNoFilter = `-- name: SearchTransportersNoFilter :many
SELECT id, project_id, company_name, contact_person, phone, gst_number,
       is_active, created_at, updated_at
FROM transporters
WHERE project_id = ?
ORDER BY company_name ASC
LIMIT ? OFFSET ?
`

type SearchTransportersNoFilterParams struct {
	ProjectID int64
	Limit     int64
	Offset    int64
}

func (q *Queries) SearchTransportersNoFilter(ctx context.Context, arg SearchTransportersNoFilterParams) ([]Transporter, error) {
	rows, err := q.db.QueryContext(ctx, SearchTransportersNoFilter, arg.ProjectID, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Transporter{}
	for rows.Next() {
		var i Transporter
		if err := rows.Scan(
			&i.ID,
			&i.ProjectID,
			&i.CompanyName,
			&i.ContactPerson,
			&i.Phone,
			&i.GstNumber,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const UpdateTransporter = `-- name: UpdateTransporter :exec
UPDATE transporters SET
    company_name = ?, contact_person = ?, phone = ?, gst_number = ?,
    is_active = ?, updated_at = CURRENT_TIMESTAMP
WHERE id = ? AND project_id = ?
`

type UpdateTransporterParams struct {
	CompanyName   string
	ContactPerson sql.NullString
	Phone         sql.NullString
	GstNumber     sql.NullString
	IsActive      sql.NullBool
	ID            int64
	ProjectID     int64
}

func (q *Queries) UpdateTransporter(ctx context.Context, arg UpdateTransporterParams) error {
	_, err := q.db.ExecContext(ctx, UpdateTransporter,
		arg.CompanyName,
		arg.ContactPerson,
		arg.Phone,
		arg.GstNumber,
		arg.IsActive,
		arg.ID,
		arg.ProjectID,
	)
	return err
}
