{{ define "title" }}New Shipment - Setup{{ end }}

{{ define "content" }}
<div class="max-w-4xl mx-auto">
    {{ template "wizard_steps" . }}

    <form method="POST" action="{{.basePath}}/shipments/wizard/step2" id="wizard-step1-form">
        {{ .csrfField }}

        <div class="card p-6 space-y-8">
            <!-- DC Template -->
            <div>
                <label for="template_id" class="block text-sm font-medium text-gray-700 mb-1">DC Template</label>
                <select name="template_id" id="template_id" required
                    class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500"
                    hx-get="{{.basePath}}/shipments/wizard/products-preview"
                    hx-target="#product-preview"
                    hx-swap="innerHTML"
                    hx-include="[name='template_id']">
                    <option value="">-- Select a template --</option>
                    {{ range .templates }}
                    <option value="{{ .ID }}">{{ .Name }}</option>
                    {{ end }}
                </select>
            </div>

            <!-- Number of Sets -->
            <div>
                <label for="num-sets-input" class="block text-sm font-medium text-gray-700 mb-1">Number of Sets</label>
                <input type="number" name="num_sets" value="1" min="1" id="num-sets-input"
                    class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
                <p id="sets-info" class="text-sm text-gray-500 mt-1">This will create 1 Transit DC + 1 Official DC</p>
            </div>

            <!-- Challan Date -->
            <div>
                <label for="challan_date" class="block text-sm font-medium text-gray-700 mb-1">Challan Date</label>
                <input type="date" name="challan_date" id="challan_date" required
                    value="{{ .today }}"
                    class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
            </div>

            <!-- Transport Details -->
            <div>
                <h3 class="text-sm font-medium text-gray-700 mb-3">Transport Details</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="transporter_name" class="block text-sm font-medium text-gray-700 mb-1">Transporter Name</label>
                        <input type="text" name="transporter_name" id="transporter_name"
                            class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
                    </div>
                    <div>
                        <label for="vehicle_number" class="block text-sm font-medium text-gray-700 mb-1">Vehicle Number</label>
                        <input type="text" name="vehicle_number" id="vehicle_number"
                            class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
                    </div>
                    <div>
                        <label for="docket_number" class="block text-sm font-medium text-gray-700 mb-1">Docket Number</label>
                        <input type="text" name="docket_number" id="docket_number"
                            class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
                    </div>
                    <div>
                        <label for="eway_bill_number" class="block text-sm font-medium text-gray-700 mb-1">E-Way Bill Number</label>
                        <input type="text" name="eway_bill_number" id="eway_bill_number"
                            class="w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500">
                    </div>
                </div>
            </div>

            <!-- Tax Configuration -->
            <div>
                <h3 class="text-sm font-medium text-gray-700 mb-3">Tax Configuration</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tax Type</label>
                        <div class="flex items-center space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="tax_type" value="cgst_sgst" checked
                                    class="text-brand-600 focus:ring-brand-500">
                                <span class="ml-2 text-sm text-gray-700">CGST + SGST</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="tax_type" value="igst"
                                    class="text-brand-600 focus:ring-brand-500">
                                <span class="ml-2 text-sm text-gray-700">IGST</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Reverse Charge</label>
                        <div class="flex items-center space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="reverse_charge" value="N" checked
                                    class="text-brand-600 focus:ring-brand-500">
                                <span class="ml-2 text-sm text-gray-700">No</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="reverse_charge" value="Y"
                                    class="text-brand-600 focus:ring-brand-500">
                                <span class="ml-2 text-sm text-gray-700">Yes</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Product Preview -->
            <div>
                <h3 class="text-sm font-medium text-gray-700 mb-3">Product Preview</h3>
                <div id="product-preview" class="rounded-lg border border-gray-200 p-4 text-sm text-gray-500 text-center">
                    Select a template to preview products
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="flex items-center justify-between mt-6">
            <a href="{{.basePath}}/dcs" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-primary">Next: Addresses â†’</button>
        </div>
    </form>
</div>

<script>
document.getElementById('num-sets-input').addEventListener('input', function() {
    var n = parseInt(this.value) || 1;
    document.getElementById('sets-info').textContent =
        'This will create 1 Transit DC + ' + n + ' Official DC' + (n > 1 ? 's' : '');
});
</script>
{{ end }}
